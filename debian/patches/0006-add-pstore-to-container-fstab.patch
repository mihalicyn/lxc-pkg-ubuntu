From 84bce17b8bc5c69e8dce03457a5f7859e0b46940 Mon Sep 17 00:00:00 2001
From: Serge Hallyn <serge.hallyn@ubuntu.com>
Date: Fri, 13 Sep 2013 15:43:56 -0500
Subject: [PATCH] add pstore to container fstab
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Otherwise user-namespace containers will hang on mountall.

Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com>
Acked-by: St√©phane Graber <stgraber@ubuntu.com>
---
 templates/lxc-ubuntu-cloud.in | 1 +
 templates/lxc-ubuntu.in       | 1 +
 2 files changed, 2 insertions(+)

Index: lxc-1.0.0~alpha1/templates/lxc-ubuntu-cloud.in
===================================================================
--- lxc-1.0.0~alpha1.orig/templates/lxc-ubuntu-cloud.in	2013-09-10 17:22:00.000000000 -0500
+++ lxc-1.0.0~alpha1/templates/lxc-ubuntu-cloud.in	2013-09-16 11:49:57.373028184 -0500
@@ -116,6 +116,7 @@ sysfs           sys          sysfs defau
 /sys/fs/fuse/connections sys/fs/fuse/connections none bind 0 0
 /sys/kernel/debug sys/kernel/debug none bind 0 0
 /sys/kernel/security sys/kernel/security none bind 0 0
+/sys/fs/pstore sys/fs/pstore none bind,optional 0 0
 EOF
 
     # unprivileged user can't mknod these.  One day we may allow
Index: lxc-1.0.0~alpha1/templates/lxc-ubuntu.in
===================================================================
--- lxc-1.0.0~alpha1.orig/templates/lxc-ubuntu.in	2013-09-10 17:22:00.000000000 -0500
+++ lxc-1.0.0~alpha1/templates/lxc-ubuntu.in	2013-09-16 11:50:02.525028383 -0500
@@ -430,6 +430,7 @@ sysfs           sys          sysfs defau
 /sys/fs/fuse/connections sys/fs/fuse/connections none bind 0 0
 /sys/kernel/debug sys/kernel/debug none bind 0 0
 /sys/kernel/security sys/kernel/security none bind 0 0
+/sys/fs/pstore sys/fs/pstore none bind,optional 0 0
 EOF
 
     if [ $? -ne 0 ]; then
