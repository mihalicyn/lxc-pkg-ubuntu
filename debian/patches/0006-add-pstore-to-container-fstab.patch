From 84bce17b8bc5c69e8dce03457a5f7859e0b46940 Mon Sep 17 00:00:00 2001
From: Serge Hallyn <serge.hallyn@ubuntu.com>
Date: Fri, 13 Sep 2013 15:43:56 -0500
Subject: [PATCH] add pstore to container fstab
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Otherwise user-namespace containers will hang on mountall.

Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com>
Acked-by: St√©phane Graber <stgraber@ubuntu.com>
---
 templates/lxc-ubuntu-cloud.in | 1 +
 templates/lxc-ubuntu.in       | 1 +
 2 files changed, 2 insertions(+)

diff --git a/templates/lxc-ubuntu-cloud.in b/templates/lxc-ubuntu-cloud.in
index 0abc932..b024de8 100644
--- a/templates/lxc-ubuntu-cloud.in
+++ b/templates/lxc-ubuntu-cloud.in
@@ -116,6 +116,7 @@ sysfs           sys          sysfs defaults  0 0
 /sys/fs/fuse/connections sys/fs/fuse/connections none bind 0 0
 /sys/kernel/debug sys/kernel/debug none bind 0 0
 /sys/kernel/security sys/kernel/security none bind 0 0
+/sys/fs/pstore sys/fs/pstore none bind 0 0
 EOF
 
     # unprivileged user can't mknod these.  One day we may allow
diff --git a/templates/lxc-ubuntu.in b/templates/lxc-ubuntu.in
index 6f6f3e1..02ccbc2 100644
--- a/templates/lxc-ubuntu.in
+++ b/templates/lxc-ubuntu.in
@@ -430,6 +430,7 @@ sysfs           sys          sysfs defaults  0 0
 /sys/fs/fuse/connections sys/fs/fuse/connections none bind 0 0
 /sys/kernel/debug sys/kernel/debug none bind 0 0
 /sys/kernel/security sys/kernel/security none bind 0 0
+/sys/fs/pstore sys/fs/pstore none bind 0 0
 EOF
 
     if [ $? -ne 0 ]; then
-- 
1.8.3.2

