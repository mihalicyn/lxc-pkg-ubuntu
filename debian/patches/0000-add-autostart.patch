Description: Add autostart support to LXC
 Autostart isn't currently upstream yet, so we need a patch to lxc-destroy
 and lxc-ls to properly managed the flag.
Author: St√©phane Graber <stgraber@ubuntu.com>
Origin: vendor
Forwarded: no

Index: raring-lxc/src/lxc/lxc-destroy.in
===================================================================
--- raring-lxc.orig/src/lxc/lxc-destroy.in	2013-03-19 10:35:53.501404552 -0400
+++ raring-lxc/src/lxc/lxc-destroy.in	2013-03-19 10:35:53.493404552 -0400
@@ -144,3 +144,6 @@
 
 # recursively remove the container to remove old container configuration
 rm -rf --one-file-system --preserve-root $lxc_path/$lxc_name
+
+# remove auto-start file if present
+rm -f /etc/lxc/auto/$lxc_name.conf /etc/lxc/auto/$lxc_name
Index: raring-lxc/src/lxc/lxc-ls
===================================================================
--- raring-lxc.orig/src/lxc/lxc-ls	2013-03-19 10:35:53.501404552 -0400
+++ raring-lxc/src/lxc/lxc-ls	2013-03-19 10:35:53.493404552 -0400
@@ -131,7 +131,8 @@
 parser.add_argument("--fancy", action="store_true",
                     help=_("use fancy output"))
 
-parser.add_argument("--fancy-format", type=str, default="name,state,ipv4,ipv6",
+parser.add_argument("--fancy-format", type=str, default="name,state,ipv4,ipv6"
+                                                        ",autostart",
                     help=_("comma separated list of fields to show"))
 
 parser.add_argument("--nesting", dest="nesting", action="store_true",
@@ -206,6 +207,11 @@
         entry['pid'] = "-"
         if container.init_pid != -1:
             entry['pid'] = str(container.init_pid)
+    if (os.path.exists("/etc/lxc/auto/%s.conf" % container_name) or
+            os.path.exists("/etc/lxc/%s" % container_name)):
+        entry['autostart'] = "YES"
+    else:
+        entry['autostart'] = "NO"
 
     # Get the IPs
     for protocol in ('ipv4', 'ipv6'):
