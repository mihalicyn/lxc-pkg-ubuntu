Index: lxc/src/tests/containertests.c
===================================================================
--- lxc.orig/src/tests/containertests.c	2012-09-04 15:08:21.252452889 -0500
+++ lxc/src/tests/containertests.c	2012-09-04 15:22:19.260422311 -0500
@@ -220,7 +220,9 @@
 
 	printf("hit return to start container");
 	char mychar;
-	scanf("%c", &mychar);
+	ret = scanf("%c", &mychar);
+	if (!ret)
+		goto out;
 
 	/* non-daemonized is tested in 'startone' */
 	c->want_daemonize(c);
@@ -242,7 +244,9 @@
 	}
 
 	printf("hit return to finish");
-	scanf("%c", &mychar);
+	ret = scanf("%c", &mychar);
+	if (!ret)
+		goto out;
 
 	fprintf(stderr, "all lxc_container tests passed for %s\n", c->name);
 	ret = 0;
Index: lxc/src/tests/startone.c
===================================================================
--- lxc.orig/src/tests/startone.c	2012-09-04 14:53:59.855772000 -0500
+++ lxc/src/tests/startone.c	2012-09-04 15:24:48.676416859 -0500
@@ -144,7 +144,8 @@
 
 	printf("hit return to start container");
 	char mychar;
-	scanf("%c", &mychar);
+	if (!scanf("%c", &mychar))
+		goto out;
 
 	if (!lxc_container_get(c)) {
 		fprintf(stderr, "%d: failed to get extra ref to container\n", __LINE__);
@@ -171,17 +172,30 @@
 	}
 
 	printf("hit return to finish");
-	scanf("%c", &mychar);
+	if (scanf("%c", &mychar))
+		goto out;
 	c->stop(c);
 
-	system("mkdir -p /var/lib/lxc/lxctest1/rootfs//usr/local/libexec/lxc");
-	system("mkdir -p /var/lib/lxc/lxctest1/rootfs/usr/lib/lxc/");
-	system("cp src/lxc/lxc-init /var/lib/lxc/lxctest1/rootfs//usr/local/libexec/lxc");
-	system("cp src/lxc/liblxc.so /var/lib/lxc/lxctest1/rootfs/usr/lib/lxc");
-	system("cp src/lxc/liblxc.so /var/lib/lxc/lxctest1/rootfs/usr/lib/lxc/liblxc.so.0");
-	system("cp src/lxc/liblxc.so /var/lib/lxc/lxctest1/rootfs/usr/lib");
-	system("mkdir -p /var/lib/lxc/lxctest1/rootfs/dev/shm");
-	system("chroot /var/lib/lxc/lxctest1/rootfs apt-get install --no-install-recommends lxc");
+	ret = system("mkdir -p /var/lib/lxc/lxctest1/rootfs//usr/local/libexec/lxc");
+	if (ret != -1)
+		ret = system("mkdir -p /var/lib/lxc/lxctest1/rootfs/usr/lib/lxc/");
+	if (ret != -1)
+		ret = system("cp src/lxc/lxc-init /var/lib/lxc/lxctest1/rootfs//usr/local/libexec/lxc");
+	if (ret != -1)
+		ret = system("cp src/lxc/liblxc.so /var/lib/lxc/lxctest1/rootfs/usr/lib/lxc");
+	if (ret != -1)
+		ret = system("cp src/lxc/liblxc.so /var/lib/lxc/lxctest1/rootfs/usr/lib/lxc/liblxc.so.0");
+	if (ret != -1)
+		ret = system("cp src/lxc/liblxc.so /var/lib/lxc/lxctest1/rootfs/usr/lib");
+	if (ret != -1)
+		ret = system("mkdir -p /var/lib/lxc/lxctest1/rootfs/dev/shm");
+	if (ret != -1)
+		ret = system("chroot /var/lib/lxc/lxctest1/rootfs apt-get install --no-install-recommends lxc");
+	if (ret == -1) {
+		fprintf(stderr, "%d: failed to install lxc-init in container", __LINE__);
+		goto out;
+	}
+
 	// next write out the config file;  does it match?
 	if (!c->startl(c, 1, "/bin/hostname", NULL)) {
 		fprintf(stderr, "%d: failed to lxc-execute /bin/hostname", __LINE__);
